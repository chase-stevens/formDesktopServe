<!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8">
      <title>Hi Mom!</title>
      <link rel="stylesheet" href="style.css">
      <script>

      </script>
    </head>
    <body>
      <h1 id="form-loaded">No Form Loaded</h1>
      <h2>Not writing to any .csv</h2>
      <div class="menu">
        <button class="load" id="load" onClick="openFile()">Load Form</button>
        <button class="serve" id="serve" onClick="addWindowEvent()">Serve Form</button>
        <button class="export" id="export" onClick="shell.openItem(`/users/chasestevens/formDesktopServe/csvData`)">Export .csv</button>
        <button class="clear" id="clear" onClick="clearForm()">Clear Form</button>
      </div>

      <script>
        const electron = require('electron');
        const { BrowserWindow, shell } = require('electron')
        const {ipcRenderer} = electron;
        var app = require('electron').remote;
        var dialog = app.dialog;
        var fs = require('fs');

        let isLoaded = false;

        function addWindowEvent(){
          ipcRenderer.send('newForm:add');
        }

        function clearForm(){
          if (isLoaded) {
            ipcRenderer.send('clearForm');
            alert("Form cleared!")
            isLoaded = false;
            document.getElementById("form-loaded").innerHTML = `No Form Loaded`;
          }
          else {
            alert("No form loaded!")
          }
        }

        function openFile() {
          dialog.showOpenDialog((fileNames) => {
            if(fileNames === undefined) {
              alert("No file selected");
            }
            else {
              readFile(fileNames[0]);
            }
          });
        };

        function readFile(filepath) {
          fs.readFile(filepath, 'utf-8', (err, data) => {
            if(err) {
              alert(err);
              return;
            }

            ipcRenderer.send("loadedFormQuestion", data);
            isLoaded = true;
            document.getElementById("form-loaded").innerHTML = `Form: ${filepath}`;
          });
        }

      </script>
    </body>
  </html>
